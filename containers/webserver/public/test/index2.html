<!DOCTYPE html>
<html lang="en" style="width: 2560px;">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>UrbanPulse Innovations - Community Management</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato&amp;display=swap">
    <link rel="stylesheet" href="assets/fonts/fontawesome-all.min.css">
    <link rel="stylesheet" href="assets/css/untitled.css">

    <!-- map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://unpkg.com/leaflet-providers@latest/leaflet-providers.js"></script>
    <!-- Leaflet Heatmap -->
    <script src="https://cdn.jsdelivr.net/npm/heatmapjs@2.0.2/heatmap.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet-heatmap@1.0.0/leaflet-heatmap.js"></script>
    <style>
        html,
        body {
            padding: 0;
            margin: 0
        }
    </style>
    <!-- /map -->
</head>

<body id="page-top" style="width: 1090px;">
    <div id="wrapper">
        <div class="d-flex flex-column" id="content-wrapper">
            <div id="content">
                <nav class="navbar navbar-light navbar-expand bg-white shadow mb-4 topbar static-top" style="transform: translateX(10px);width: 2560px;">
                    <div class="container-fluid"><button class="btn btn-link d-md-none rounded-circle me-3" id="sidebarToggleTop" type="button"><i class="fas fa-bars"></i></button>
                        <form class="d-none d-sm-inline-block me-auto ms-md-3 my-2 my-md-0 mw-100 navbar-search">
                            <div class="input-group"></div>
                        </form>
                        <h1></h1>
                        <ul class="navbar-nav flex-nowrap ms-auto" style="transform: translateX(-316px);">
                            <li class="nav-item dropdown d-sm-none no-arrow"><a class="dropdown-toggle nav-link" aria-expanded="false" data-bs-toggle="dropdown" href="#"><i class="fas fa-search"></i></a>
                                <div class="dropdown-menu dropdown-menu-end p-3 animated--grow-in" aria-labelledby="searchDropdown">
                                    <form class="me-auto navbar-search w-100">
                                        <div class="input-group"><input class="bg-light form-control border-0 small" type="text" placeholder="Search for ...">
                                            <div class="input-group-append"><button class="btn btn-primary py-0" type="button"><i class="fas fa-search"></i></button></div>
                                        </div>
                                    </form>
                                </div>
                            </li>
                            <li class="nav-item dropdown no-arrow mx-1">
                                <div class="nav-item dropdown no-arrow"><a class="dropdown-toggle nav-link" aria-expanded="false" data-bs-toggle="dropdown" href="#"></a>
                                    <div class="dropdown-menu dropdown-menu-end dropdown-list animated--grow-in">
                                        <h6 class="dropdown-header">alerts center</h6><a class="dropdown-item d-flex align-items-center" href="#">
                                            <div class="me-3">
                                                <div class="bg-primary icon-circle"><i class="fas fa-file-alt text-white"></i></div>
                                            </div>
                                            <div><span class="small text-gray-500">December 12, 2019</span>
                                                <p>A new monthly report is ready to download!</p>
                                            </div>
                                        </a><a class="dropdown-item d-flex align-items-center" href="#">
                                            <div class="me-3">
                                                <div class="bg-success icon-circle"><i class="fas fa-donate text-white"></i></div>
                                            </div>
                                            <div><span class="small text-gray-500">December 7, 2019</span>
                                                <p>$290.29 has been deposited into your account!</p>
                                            </div>
                                        </a><a class="dropdown-item d-flex align-items-center" href="#">
                                            <div class="me-3">
                                                <div class="bg-warning icon-circle"><i class="fas fa-exclamation-triangle text-white"></i></div>
                                            </div>
                                            <div><span class="small text-gray-500">December 2, 2019</span>
                                                <p>Spending Alert: We've noticed unusually high spending for your account.</p>
                                            </div>
                                        </a><a class="dropdown-item text-center small text-gray-500" href="#">Show All Alerts</a>
                                    </div>
                                </div>
                            </li>
                            <li class="nav-item dropdown no-arrow mx-1">
                                <div class="nav-item dropdown no-arrow"><a class="dropdown-toggle nav-link" aria-expanded="false" data-bs-toggle="dropdown" href="#"></a>
                                    <div class="dropdown-menu dropdown-menu-end dropdown-list animated--grow-in">
                                        <h6 class="dropdown-header">alerts center</h6><a class="dropdown-item d-flex align-items-center" href="#">
                                            <div class="dropdown-list-image me-3"><img class="rounded-circle" src="assets/img/avatars/avatar4.jpeg">
                                                <div class="bg-success status-indicator"></div>
                                            </div>
                                            <div class="fw-bold">
                                                <div class="text-truncate"><span>Hi there! I am wondering if you can help me with a problem I've been having.</span></div>
                                                <p class="small text-gray-500 mb-0">Emily Fowler - 58m</p>
                                            </div>
                                        </a><a class="dropdown-item d-flex align-items-center" href="#">
                                            <div class="dropdown-list-image me-3"><img class="rounded-circle" src="assets/img/avatars/avatar2.jpeg">
                                                <div class="status-indicator"></div>
                                            </div>
                                            <div class="fw-bold">
                                                <div class="text-truncate"><span>I have the photos that you ordered last month!</span></div>
                                                <p class="small text-gray-500 mb-0">Jae Chun - 1d</p>
                                            </div>
                                        </a><a class="dropdown-item d-flex align-items-center" href="#">
                                            <div class="dropdown-list-image me-3"><img class="rounded-circle" src="assets/img/avatars/avatar3.jpeg">
                                                <div class="bg-warning status-indicator"></div>
                                            </div>
                                            <div class="fw-bold">
                                                <div class="text-truncate"><span>Last month's report looks great, I am very happy with the progress so far, keep up the good work!</span></div>
                                                <p class="small text-gray-500 mb-0">Morgan Alvarez - 2d</p>
                                            </div>
                                        </a><a class="dropdown-item d-flex align-items-center" href="#">
                                            <div class="dropdown-list-image me-3"><img class="rounded-circle" src="assets/img/avatars/avatar5.jpeg">
                                                <div class="bg-success status-indicator"></div>
                                            </div>
                                            <div class="fw-bold">
                                                <div class="text-truncate"><span>Am I a good boy? The reason I ask is because someone told me that people say this to all dogs, even if they aren't good...</span></div>
                                                <p class="small text-gray-500 mb-0">Chicken the Dog · 2w</p>
                                            </div>
                                        </a><a class="dropdown-item text-center small text-gray-500" href="#">Show All Alerts</a>
                                    </div>
                                </div>
                                <div class="shadow dropdown-list dropdown-menu dropdown-menu-end" aria-labelledby="alertsDropdown"></div>
                            </li>
                            <div class="d-none d-sm-block topbar-divider" style="transform: translate(173px) translateX(675px);"></div>
                            <li class="nav-item dropdown no-arrow">
                                <div class="nav-item dropdown no-arrow"><a class="dropdown-toggle nav-link" aria-expanded="false" data-bs-toggle="dropdown" href="#" style="transform: translateX(-96px);"></a>
                                    <div class="dropdown-menu shadow dropdown-menu-end animated--grow-in"><a class="dropdown-item" href="#"><i class="fas fa-user fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Profile</a><a class="dropdown-item" href="#"><i class="fas fa-cogs fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Settings</a><a class="dropdown-item" href="#"><i class="fas fa-list fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Activity log</a>
                                        <div class="dropdown-divider"></div><a class="dropdown-item" href="#"><i class="fas fa-sign-out-alt fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Logout</a>
                                    </div>
                                </div>
                            </li>
                        </ul><i class="far fa-question-circle" style="transform: translate(-465px) translateX(686px);"></i><i class="far fa-chart-bar" style="transform: translate(-465px) translateX(208px);"></i><span style="font-family: Lato, sans-serif;transform: translate(-465px) translateX(217px);">Analysis</span><span style="font-family: Lato, sans-serif;transform: translate(-411px) translateX(-174px) translateY(0px);margin-right: 0px;padding-right: 0px;width: 300px;">Dispute Forum</span><span style="font-family: Lato, sans-serif;transform: translate(-192px) translateX(47px) translateY(0px);">Help</span><span style="font-family: Lato, sans-serif;transform: translate(-192px) translateX(326px) translateY(0px);width: 350px;">— UrbanPulse Innovations —</span><span style="font-family: Lato, sans-serif;transform: translate(-385px) translateX(-385px) translateY(0px);width: 300px;">Accident Report</span><i class="far fa-comments" style="transform: translate(-596px) translateX(-1000px);"></i><i class="fas fa-exclamation-triangle" style="transform: translate(-481px) translateX(-635px);"></i>
                    </div>
                </nav>
                <div class="container-fluid">
                    <div class="d-sm-flex justify-content-between align-items-center mb-4" style="transform: translateX(715px);">
                        <h3 class="text-dark mb-0" style="font-family: Lato;transform: translateX(335px);">Residential Area Management System</h3>
                    </div>
                    <div class="btn-toolbar" style="transform: translateX(984px);">
                        <div class="btn-group" role="group"><button class="btn btn-primary" type="button" style="border-radius: 20px;background: #006d5b;border-right-color: #006d5b;">All</button><button class="btn btn-primary" type="button" style="border-radius: 20px;transform: translate(9px);background: #006d5b;border-right-color: #006d5b;">Parking</button><button class="btn btn-primary" type="button" style="border-radius: 20px;transform: translate(16px);background: #006d5b;border-right-color: #006d5b;">Patrol</button></div>
                        <div class="btn-group" role="group" style="border-radius: 20px;transform: translate(11px);background: var(--bs-btn-hover-bg);color: var(--bs-orange);"><button class="btn btn-primary" type="button" style="border-radius: 20px;transform: translate(11px);background: #006d5b;border-right-color: #006d5b;">Garbage stations</button><button class="btn btn-primary" type="button" style="border-radius: 20px;transform: translate(19px);background: #006d5b;border-right-color: #006d5b;">Accidents</button><button class="btn btn-primary" type="button" style="border-radius: 20px;transform: translate(19px) translateX(9px);background: #006d5b;border-right-color: #006d5b;">Residents</button></div>
                    </div>
                    <br />
                    <div class="row">
                        <div class="col">
                            <!-- map -->
                            <div id="map" style="height: 1000px; padding:0; margin:0;"></div>
                            <!-- map -->
                            <div class="toast-container"></div>
                        </div>
                    </div>
                </div>
            </div>
            <footer class="bg-white sticky-footer">
                <div class="container my-auto">
                    <div class="text-center my-auto copyright"></div>
                </div>
            </footer>
        </div><a class="border rounded d-inline scroll-to-top" href="#page-top"><i class="fas fa-angle-up"></i></a>
    </div>
    <div style="width: 300px;background: #b44d4d;"></div>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/theme.js"></script>
    <!-- map -->
    <script>
        var baseLayer = L.tileLayer('https://{s}.tile.jawg.io/jawg-matrix/{z}/{x}/{y}{r}.png?access-token={accessToken}', {
            attribution: '<a href="http://jawg.io" title="Tiles Courtesy of Jawg Maps" target="_blank">&copy; <b>Jawg</b>Maps</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            minZoom: 0,
            maxZoom: 22,
            subdomains: 'abcd',
            accessToken: 'hiemvifLIv1RNspPeW9qVBrmEVuXLYcXanYc9QDikBwVP3aJyuZ5KpexJyxZdjrz'
        })//.addTo(map)

        // Heatmap
        function rndHeatData() {
            var center = [31.24169, 121.49491];
            var data = [];
            for (i = 0; i < 500; i++) {
                rY = randomNumber(-0.2, 0.2);
                rX = randomNumber(-0.2, 0.2);
                coord = [center[0] + rY, center[1] + rX];
                count = randomNumber(0, 5);
                data.push({ lat: coord[0], lng: coord[1], count: count });
            }
            return data;
        }
        var testData = {
            max: 5,
            data: rndHeatData()
        };
        var cfg = {
            // radius should be small ONLY if scaleRadius is true (or small radius is intended)
            // if scaleRadius is false it will be the constant radius used in pixels
            "radius": 0.02,
            "maxOpacity": .15,
            // scales the radius based on map zoom
            "scaleRadius": true,
            // if set to false the heatmap uses the global maximum for colorization
            // if activated: uses the data maximum within the current map boundaries
            //   (there will always be a red spot with useLocalExtremas true)
            "useLocalExtrema": true,
            // which field name in your data represents the latitude - default "lat"
            latField: 'lat',
            // which field name in your data represents the longitude - default "lng"
            lngField: 'lng',
            // which field name in your data represents the data value - default "value"
            valueField: 'count'
        };
        var heatmapLayer = new HeatmapOverlay(cfg);
        heatmapLayer.setData(testData);

        var map = new L.Map('map', {
            center: new L.LatLng(31.2416, 121.49491),
            zoom: 13,
            layers: [baseLayer, heatmapLayer]
        });

        function addPoint(point) {
            var CustomIcon = L.Icon.extend({
                options: {
                    iconSize: [40, 42],
                    iconAnchor: [20, 0],
                }
            });
            var Icon = new CustomIcon({ iconUrl: point.icon })
            var marker = L.marker(point.coords, { icon: Icon }).addTo(map);

            marker.bindPopup("<b>" + point.title + "</b>" + point.text);
        }

        function randomNumber(min, max) {
            return Math.random() * (max - min) + min;
        }
        center = [31.24169, 121.49491];
        var points = [];
        function rndVideoFeed() {
            // pick random processed feed and load
            maxFeed = 5;
            feed = Math.floor(Math.random() * maxFeed)
            html = "<video src=\"videos-cv/" + feed + ".mp4\" loop nocontrols autoplay style=\"max-width: 265px; padding-left: 8px; padding-top: 5px;\"></video>"
            return html
        }

        function loadPointsAttention(json, num) {
            jsonc = [];
            for (let index = 0; index < num; index++) {
                jsonc.push(json[(Math.floor(Math.random() * json.length))])
            }
            jsonc.forEach(e => {
                coord = [e.coordinates.latitude, e.coordinates.longitude];
                icon = "img/accident3.png"
                title = "Accident Reported"
                text = "<p><b>Time:</b> " + e.timestamp + "<br />"
                text += "<b>Emergency Contact:</b> " + e.emergencyContact + "<br />"
                text += "<b>Emergency Type:</b> " + e.emergencyType + "<br />"
                text += "<b>Address:</b> " + e.address + "<br />"
                text += "<b>Note:</b> " + e.note + "</p>"

                points.push({ "coords": coord, "icon": icon, "title": title, "text": text });
            });
        }
        function loadPointsGarbage(json, num) {
            jsonc = [];
            for (let index = 0; index < num; index++) {
                jsonc.push(json[(Math.floor(Math.random() * json.length))])
            }
            jsonc.forEach(e => {
                coord = [e.coordinates.latitude, e.coordinates.longitude];
                icon = "img/trash3.png"
                title = "Garbage Collection Station"
                stats = ["Empty", "20% Full", "40% Full", "60% Full", "80% Full", "100% Full"];
                status = stats[(Math.floor(Math.random() * stats.length))];
                text = "<p><b>Time:</b> " + e.timestamp + "<br />"
                text += "<b>Status:</b> " + status + "<br />";
                text += "<b>Address:</b> " + e.address + "<br />"
                text += "<b>Person in Charge:</b> " + e.personInCharge + "</p>";

                points.push({ "coords": coord, "icon": icon, "title": title, "text": text });
            });
        }
        function loadPointsParking(json, num) {
            jsonc = [];
            for (let index = 0; index < num; index++) {
                jsonc.push(json[(Math.floor(Math.random() * json.length))])
            }
            jsonc.forEach(e => {
                coord = [e.coordinates.latitude, e.coordinates.longitude];
                icon = "img/parking3.png"
                title = "Parking Live Feed"
                text = "<p><b>Number of Cars:</b> " + e.numberOfCars + "<br />"
                text += "<b>Address:</b> " + e.address + "<br />"
                text += rndVideoFeed() + "</p>";

                points.push({ "coords": coord, "icon": icon, "title": title, "text": text });
            });
        }
        function loadPointsPatrol(json, num) {
            jsonc = [];
            for (let index = 0; index < num; index++) {
                jsonc.push(json[(Math.floor(Math.random() * json.length))])
            }
            jsonc.forEach(e => {
                coord = [e.coordinates.latitude, e.coordinates.longitude];
                icon = "img/patrol3.png"
                title = "Police Patrol"
                text = "<p><b>Time:</b> " + e.timestamp + "<br />"
                text += "<b>Current Location: </b>" + e.address + "<br>"
                text += "<b>Officer Contact:</b> " + e.officerContact + "</p>"

                points.push({ "coords": coord, "icon": icon, "title": title, "text": text });
            });
        }

        points = [];

        function syncGet(url) {
            const request = new XMLHttpRequest();
            request.open("GET", url, false); // `false` makes the request synchronous
            request.send(null);

            if (request.status === 200) {
                return JSON.parse(request.responseText);
            }

        }

        num = 8
        json = syncGet("json/fake_attention_data.json")
        loadPointsAttention(json, num)
        json = syncGet("json/fake_garbage_station_data.json")
        loadPointsGarbage(json, num)
        json = syncGet("json/fake_parked_cars_data.json")
        loadPointsParking(json, num)
        json = syncGet("json/fake_patrol_data.json")
        loadPointsPatrol(json, num)

        points.forEach((point) => {
            addPoint(point);
        });
 
        var residentsShow = true;
        function toggleResidents() {
            if (residentsShow == true) {
                
            } else {

            }
            residentsShow = !residentsShow;
        }
    </script>
</body>

</html>